<div class="header">
    <button class="btn btn-outline-primary fs-5 px-4" (click)="backToSearchHotel()"> Back </button> &nbsp;&nbsp;
    <h4 class="mx-3 mt-2">Hotel Results</h4>
</div>
<div style="height: 0.5px; background-color: black;   "></div>

<div class="hotel-details text-black" *ngFor="let hotel of hotelDetails">
    <div class="hotel-left">
        <H1 style="font-size: 30px; font-family: 'Times New Roman', Times, serif;">
            <strong>{{hotel.name}}</strong>
        </H1>
        <div class="hotel-images">
            <img class="border rounded-4" src={{hotel.hotelImage1}} alt="1st Image" width="550px" height="320px">
            <div class="d-flex flex-column gap-2">
                <img class="border rounded-4" src={{hotel.hotelImage2}} alt="" width="270px" height="155px">
                <img class="border rounded-4" src={{hotel.hotelImage3}} alt="" width="270px" height="155px">
            </div>
        </div>
        <p class=" mt-4 mb-0 "><strong>Detail :</strong></p>
        <p>{{hotel.description}} </p>
        <div class="d-flex flex-column">
            <h5 class="fw-400">Amenities</h5>
            <h6 class="amenities">{{hotel.amenities}} </h6>
        </div>
        <div class="container-main">
            <div class="reviews rounded" #review>
                <div class="headingReview d-flex flex-wrap">
                    <h3 class="m-2 SummaryReview-Heading">Users Ratings & Reviews</h3>
                    <button type="button" class="btn btn-primary mt-3" data-bs-toggle="modal"
                        data-bs-target="#exampleModal">Add
                        Review</button>
                </div>
                <hr>
                <div class="container-allreviews d-flex flex-wrap m-2 rounded">
                    <div class="container-summaryreview d-flex flex-column rounded m">
                        <div class="container-reviews card my-2" *ngFor="let review of getPaginatedReviews()">
                            <div class="listedreview  d-flex">
                                <label class="summary-label text-center rounded m-2 p-1"
                                    for="ratings">{{review.rating}}</label>
                                <div class="headingreviews mt-1">
                                    <h6 class="mt-2" *ngIf="review.rating == '5.0'">Excellent</h6>
                                    <h6 class="mt-2" *ngIf="review.rating == '4.0'">Very Good</h6>
                                    <h6 class="mt-2" *ngIf="review.rating == '3.0'">Average</h6>
                                    <h6 class="mt-2" *ngIf="review.rating == '2.0'">Poor</h6>
                                    <h6 class="mt-2" *ngIf="review.rating == '1.0'">Bad</h6>
                                    <p class="fw-smaller">{{review.name}}</p>
                                </div>
                                <div class="ReviewDate ms-2 mt-2">
                                <p>Date : {{review.timestamp| date : 'short'}}</p>
                            </div>
                            </div>
                            <div class="detailedreviews ms-2">
                                <p>{{review.comment}}</p>
                            </div>
                            

                        </div>

                        <nav *ngIf="isNavDisabled == false">
                            <ul class="pagination justify-content-center">
                                <li class="page-item" [class.disabled]="currentPage === 1">
                                    <button class="page-link" (click)="changePage(currentPage - 1)">Previous</button>
                                </li>

                                <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index"
                                    [class.active]="currentPage === i + 1">
                                    <button class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</button>
                                </li>

                                <li class="page-item" [class.disabled]="currentPage === totalPages">
                                    <button class="page-link" (click)="changePage(currentPage + 1)">Next</button>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

    </div>
     <div class="hotel-right">
        <div class="container-starrating rounded m-1 ">
            <div class="averagerating d-flex flex-row w-100">
                <label class="averageLogolable text-white fs-2 mt-2 text-center" for="average">{{
                    calculateAverageRating() | number:'1.1-1'}}</label>
                <div class="overallrating-container ms-2 justify-content-center align-content-center">
                    <h5 class="overallrating mt-2" *ngIf="flooredValue() == 5">Excellent</h5>
                    <h5 class="overallrating mt-2" *ngIf="flooredValue() == 4">Very Good</h5>
                    <h5 class="overallrating mt-2" *ngIf="flooredValue() == 3">Average</h5>
                    <h5 class="overallrating mt-2" *ngIf="flooredValue() == 2">Poor</h5>
                    <h5 class="overallrating mt-2" *ngIf="flooredValue() == 1">Bad</h5>
                    <p class="overallrating-text">{{totalRating()}} Ratings, <a
                            (click)="scrollToReview()">{{totalReviews()}} Reviews</a></p>
                </div>

            </div>
             <div class="progressrating my-3 rounded">
                <div class="progress w-100 h-25 bg-white">
                    <div class="progressreview w-25 me-2">
                        <span class="progress-label">Excellent</span>
                    </div>
                    <div class="progressbar mt-2 d-flex flex-column">
                        <progress class="progress-stick" id="file" value="{{calculatePercentageofStar(5)}}"
                            max="100"></progress>
                    </div>
                    <span class="percentage-value">{{calculatePercentageofStar(5) | number:'1.1-1'}}%</span>
                </div>
                <div class="progress w-100 h-25 bg-white">
                    <div class="progressreview w-25 me-2">
                        <span class="progress-label">Very Good</span>
                    </div>
                    <div class="progressbar mt-2">
                        <progress class="progress-stick" id="file" value="{{calculatePercentageofStar(4)}}" max="100">
                        </progress>
                    </div>
                    <span class="percentage-value">{{calculatePercentageofStar(4) | number:'1.1-1'}}%</span>
                </div>
                <div class="progress w-100 h-25 bg-white">
                    <div class="progressreview w-25 me-2">
                        <span class="progress-label">Average</span>
                    </div>
                    <div class="progressbar mt-2">
                        <progress class="progress-stick" id="file" value="{{calculatePercentageofStar(3)}}" max="100">
                        </progress>
                    </div>
                    <span class="percentage-value">{{calculatePercentageofStar(3) | number:'1.1-1'}}%</span>
                </div>
                <div class="progress w-100 h-25 bg-white">
                    <div class="progressreview w-25 me-2">
                        <span class="progress-label">Poor</span>
                    </div>
                    <div class="progressbar mt-2">
                        <progress class="progress-stick" id="file" value="{{calculatePercentageofStar(2)}}" max="100">
                        </progress>
                    </div>
                    <span class="percentage-value">{{calculatePercentageofStar(2) | number:'1.1-1'}}%</span>
                </div>
                <div class="progress 100 h-25 bg-white">
                    <div class="progressreview w-25 me-2">
                        <span class="progress-label">Bad</span>
                    </div>
                    <div class="progressbar mt-2">
                        <progress class="progress-stick" id="file" value="{{calculatePercentageofStar(1)}}"
                            max="100"></progress>
                    </div>
                    <span class="percentage-value">{{calculatePercentageofStar(1) | number:'1.1-1'}}%</span>
                </div>
            </div>
        </div>

        <div class="all-benefits">
            <h4 class="mb-2">Benefits :-</h4>
            <h6 class="benefits" *ngIf="hotel.customerSupport > '0' "> • {{hotel.customerSupport}}
            </h6>
            <h6 class="benefits" *ngIf="hotel.earlyCheckIn > '0' ">• {{hotel.earlyCheckIn}} </h6>
            <h6 class="benefits" *ngIf="hotel.freeBreakfast > '0' "> • {{hotel.freeBreakfast}}
            </h6>
            <h6 class="benefits" *ngIf="hotel.flexibleCancellation > '0' "> •
                {{hotel.flexibleCancellation}} </h6>
            <h6 class="benefits" *ngIf="hotel.loyaltyRewards > '0' "> • {{hotel.loyaltyRewards}}
            </h6>
        </div>
        <div class="price">
            <h6><strong>Price Per Night :</strong></h6>
            <h6>{{hotel.pricePerNight | currency : 'INR':'symbol':'1.0-0'}} </h6>
        </div>
        <div class="availablerooms">
            <h6><strong>Available Rooms :</strong></h6>
            <h6>{{hotel.roomsAvailable}} </h6>
        </div>
        <h5 class="fw-bold mt-4 mb-3"> Location</h5>
        <div class="location d-flex flex-column">
            <h6>{{hotel.address}} , {{hotel.pincode}} ,</h6>
            <h6>{{hotel.city}} ,</h6>
            <h6>{{hotel.landmark}}</h6>
        </div>
        <div class="map">
            <h5>Search on Google </h5>
            <a class="fw-bold" href={{hotel.mapLink}}>Map</a>
        </div>
        <button class=" book-button btn btn-outline-primary text-center" (click)="goToPayment(hotel.hotelId)">Book
            Now</button>

    </div>
</div>

<div class="modal fade modal-form" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered rounded-3">
        <div class="modal-content">

            <form class="addReview" [formGroup]="addReview" (submit)="AddReview()">

                <img class="modal-image" src="Review-Background.jpg" alt="" height="60%" width="100%">
                <div class="modal-body d-flex flex-column">
                    <div class="star-ratings d-flex flex-column">
                        <div class="stars align-self-center">
                            <h6 class="text-center">Rating:</h6>
                            <span *ngFor="let star of stars" (click)="setRating(star)"
                                class="modal-star-review mx-1 text-center">
                                <i [ngClass]="star <= ratings ? 'bi bi-star-fill' : 'bi bi-star'"></i>
                            </span>
                        </div>
                        <div>
                            <p class="text-danger" *ngIf="rating?.errors?.['required'] && (rating?.dirty || rating?.touched)">
                                This field is required!
                            </p>
                            <p *ngIf="!(rating?.errors?.['required'])">&nbsp;</p>
                        </div>
                        <div class="detailedReview d-flex flex-column align-items-center">
                            <div class="modal-user d-flex flex-column mt-2">
                                <label for="name">User Name: </label>
                                <input type="text" class="review-name" id="name" formControlName="name"
                                    placeholder="Enter your name">
                            </div>
                            <div>
                                <p class="text-danger"
                                    *ngIf="name?.errors?.['required'] && (name?.dirty || name?.touched)">
                                    This field is required!
                                </p>
                                <p *ngIf="!(name?.errors?.['required'])">&nbsp;</p>
                            </div>
                            <div class="modal-detailed-review d-flex flex-column mt-3">
                                <label for="userReview">Give Detailed Review:</label>
                                <textarea class="detailedReview-dialoge" name="detailedReview" id="detailedReview"
                                    formControlName="detailedReview" rows="3"
                                    placeholder="Describe your review in detail..."></textarea>
                            </div>
                            <div>
                                <p class="text-danger"
                                    *ngIf="detailedReview?.errors?.['required'] && (detailedReview?.dirty || detailedReview?.touched)">
                                    This field is required!
                                </p>
                                <p *ngIf="!(detailedReview?.errors?.['required'])">&nbsp;</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer d-flex flex-wrap">
                    <button type="button" class="btn btn-secondary close-btn rounded" data-bs-dismiss="modal"
                        (click)="Closed()">Close</button>
                    <button type="submit" class="btn btn-primary add-btn rounded" [disabled]="addReview.invalid"
                        data-bs-dismiss="modal">Add</button>
                </div>
            </form>
        </div>
    </div>
</div>