<app-navbar></app-navbar>

<div *ngIf="packages && packages.length === 0 " class="text-center">
  <div class="alert alert-warning py-4 px-3 rounded-3 shadow-sm" role="alert">
    <h4 class="alert-heading fw-bold text-danger">Oops! No Packages Found</h4>
    <p class="mb-2">
      We couldn't find any travel packages you searched.
    </p>
    <hr />
    <p class="mb-0 text-muted">
      Try exploring other destinations or check back later for new updates.
    </p>
  </div>
</div>

<div *ngIf="packages.length > 0">
  <!-- Packages detail view -->

  <div *ngIf="bdisplayPackageDetails && selectedPackage">
    <div class="m-3">
      <h2 class="" style="font-size: 28px; font-weight: bold">{{selectedPackage.title}}</h2>
      <div class="d-flex py-2">
        <div class="border p-1 rounded d-flex justify-content-center align-items-center" style="font-size: x-small">
          <i class="bi bi-shuffle px-2"></i>
          Customizable
        </div>
        <div class="border p-1 rounded mx-2 d-flex justify-content-center align-items-center"
          style="font-size: x-small">
          {{selectedPackage.duration}}
        </div>
        <div class="p-1" style="font-size: 14px"></div>
      </div>
    </div>
    <div class="container p-0 d-flex flex-row m-2 gap-2 align-items-start col-12 col-lg-9 mb-4">
      <img class="border rounded-2 object-fit-cover" src="{{selectedPackage.imageUrl}}" alt="Main Image" width="650px"
        height="400px">
      <div class="d-flex flex-column gap-2 ">
        <ng-container *ngFor="let image of itiernary?. imagesUrls; let i = index ">
          <div *ngIf="i <2">
            <img class="border rounded-2 object-fit-cover" src="{{image}}" alt="Thumbnail" width="350px" height="195px">
          </div>
        </ng-container>
      </div>
      <div>
        <ng-container *ngFor="let image of itiernary?.imagesUrls; let i = index ">
          <div *ngIf="i >= 2">
            <img class="border rounded-2 object-fit-cover" src="{{image}}" alt="Thumbnail" width="300px" height="400px">
          </div>
        </ng-container>
      </div>
    </div>

    <!-- itiernary display -->
    <div class="container-fluid my-4">
      <div class="row">

        <!-- Main Itinerary Section -->
        <div class="col-12 col-lg-9 mb-4">
          <div class="rounded shadow-lg">

            <!-- Navbar -->
            <div class="bg-info px-3 py-2 rounded-top">
              <button class="btn btn-primary text-white">
                Plan for {{ itiernary?.dayItinerary?.length || 0 }} days
              </button>
            </div>

            <div class="row g-0 border-top">
              <!-- Main Content -->
              <div class=" p-4 overflow-auto" data-bs-target="#list-example" style="max-height: 600px;"
                data-bs-offset="0" tabindex="0">

                <div *ngFor="let dayPlan of itiernary?.dayItinerary; let i = index" [routerLink]="[]"
                  [fragment]="'day-' + i" class="mb-5 border-top pt-4">
                  <h4 class="text-primary mb-2">Day {{ dayPlan.day }} : {{ dayPlan.title }}</h4>
                  <p class="text-muted">{{ dayPlan.description }}</p>

                  <p><strong>Meals Included:</strong> {{ dayPlan.mealsIncluded || 'None' }}</p>
                  <p><strong>Overnight Stay:</strong> {{ dayPlan.overnightStay }}</p>

                  <p><strong>Highlights:</strong>{{dayPlan.highlights }}</p>
          
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- Payment Card -->
        <div class="col-12 col-lg-3 border-1 " style="max-height: 15rem;">
          <div class="p-4 shadow-lg rounded bg-white h-100 d-flex flex-column">
            <div>
              <h5 class="mb-2">Total Price</h5>
              <hr>
              <h4 class="mb-1">
                â‚¹{{ selectedPackage.price }}
                <small class="text-muted" style="font-weight: 400;">/per adult</small>
              </h4>
              <p class="text-muted" style="font-size: 0.9rem;">Excluding applicable taxes</p>
            </div>
            <div class="text-center mt-3">
              <button class="btn btn-info w-100" (click)="gotopaymentpage()">Proceed to payment</button>
            </div>
          </div>
        </div>

      </div>
    </div>

  </div>




  <!-- list pacakages  -->
  <div *ngIf="bdisplayPackageDetails == false">

    <!-- nav-search bar -->
    <div class="container-fluid shadow-sm rounded sticky-top" style="background-color:#2c3e50; position: sticky; ">
      <div class="d-flex mx-5">
        <div class="row bg-white p-2 w-auto rounded m-3 mx-0 " style="max-width: 200px; max-height: 60px;">
          <label for="startlocation" class="text-primary text-uppercase">Starting From</label>
          <input type="text" [(ngModel)]="startlocation" value="{{startlocation}}" class="border-0" />
        </div>
        <div class="row bg-white p-2 rounded m-3 mx-2" style="max-width: 200px; max-height: 60px;">
          <label for="endlocation" class="text-primary text-uppercase">Going to</label>
          <input type="text" value="{{endlocation}}" [(ngModel)]="endlocation" class="border-0" required />
        </div>

        <div class="row bg-white p-2 rounded m-3 mx-0" style="max-width: 200px; max-height: 60px;">
          <label for="date" class="text-primary text-uppercase">Starting Date</label>
          <input type="date" id="date" [(ngModel)]="startingDate" name="startingDate" class="border-0" required [min]="minDate" />
        </div>

        <button type="submit" (click)="onSearch()" class="btn m-3 mx-2 fw-bold px-5 btn-primary ">SEARCH</button>
      </div>
    </div>

    <!-- image carousel -->
    <div id="carouselExampleInterval" class="carousel slide position-relative" data-bs-ride="carousel">
      <div class="position-absolute start-50 bottom-0 translate-middle text-center p-4 text-white z-3">
        <h5 class="text-capitalize" style="
          font-family: 'Amsterdam Signature';
          font-size: 4rem;
          text-shadow: 2px 2px 4px #000000;
        ">
          {{ location }} tour Packages
        </h5>
      </div>
      <div class="carousel-inner">
        <div *ngFor="let carouselimg of carouselImages; let i = index" class="carousel-item" [class.active]="i === 0"
          data-bs-interval="2000">
          <img [src]="carouselimg" class="d-block w-100 image-bottom" alt="Package image" />
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval"
        data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval"
        data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>

    <!-- package display -->
    <div class="bg-white mt-4 mb-3">
      <div class="container-fluid">
        <h5 class="fw-bold text-primary">
          Top Selling
          <strong class="text-dark text-capitalize">{{ location }} Packages
          </strong>
        </h5>
        <div class="row mt-3">
          <div class="col-md-4 mb-3" *ngFor="let pkg of packages">
            <div class="card shadow-sm border-1" style="font-size: 0.9rem">
              <div class="position-relative">
                <img src="{{pkg.imageUrl}}" class="card-img-top" alt="Goa Beach"
                  style="height: 250px;  object-fit: cover" />
                <span class="badge bg-danger text-white position-absolute top-0 start-0 m-2 px-2 py-1 rounded-sm"
                  style="font-size: 0.75rem">Top Seller</span>
                <span class="badge bg-white text-dark position-absolute bottom-0 start-0 m-2 px-2 py-1 rounded-sm"
                  style="font-size: 0.75rem">{{ pkg.duration }}</span>
              </div>
              <div class="card-body p-3 pt-0 d-flex flex-column">
                <div class="d-flex justify-content-between align-items-center mb-2">
                  <h6 class="fw-bold mb-0">{{ pkg.title }}</h6>
                  <div class="text-danger text-end">
                    <h6 class="fw-bold pt-2 mb-0">&#8377; {{ pkg.price }}</h6>
                    <small class="text-muted gst_tag">Gst Included</small>
                  </div>
                </div>
                <div class="d-flex flex-wrap gap-1 my-2">
                  <span class="badge" style="font-size: 0.7rem; color: rgb(184, 184, 184)"
                    *ngFor="let feature of pkg.features">
                    <div *ngIf="feature == 'Flight'">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                        class="bi bi-airplane-fill" viewBox="0 0 16 16">
                        <path
                          d="M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849" />
                      </svg>
                    </div>
                    <div *ngIf="feature == 'Hotel'">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                        class="bi bi-building-fill-check" viewBox="0 0 16 16">
                        <path
                          d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514" />
                        <path
                          d="M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7.256A4.5 4.5 0 0 0 12.5 8a4.5 4.5 0 0 0-3.59 1.787A.5.5 0 0 0 9 9.5v-1a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .39-.187A4.5 4.5 0 0 0 8.027 12H6.5a.5.5 0 0 0-.5.5V16H3a1 1 0 0 1-1-1zm2 1.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5m3 0v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5m3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5M7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5M4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z" />
                      </svg>
                    </div>
                    <div *ngIf="feature == 'Meals'">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                        class="bi bi-fork-knife" viewBox="0 0 16 16">
                        <path
                          d="M13 .5c0-.276-.226-.506-.498-.465-1.703.257-2.94 2.012-3 8.462a.5.5 0 0 0 .498.5c.56.01 1 .13 1 1.003v5.5a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5zM4.25 0a.25.25 0 0 1 .25.25v5.122a.128.128 0 0 0 .256.006l.233-5.14A.25.25 0 0 1 5.24 0h.522a.25.25 0 0 1 .25.238l.233 5.14a.128.128 0 0 0 .256-.006V.25A.25.25 0 0 1 6.75 0h.29a.5.5 0 0 1 .498.458l.423 5.07a1.69 1.69 0 0 1-1.059 1.711l-.053.022a.92.92 0 0 0-.58.884L6.47 15a.971.971 0 1 1-1.942 0l.202-6.855a.92.92 0 0 0-.58-.884l-.053-.022a1.69 1.69 0 0 1-1.059-1.712L3.462.458A.5.5 0 0 1 3.96 0z" />
                      </svg>
                    </div>
                    <div *ngIf="feature == 'Sightseeing'">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                        class="bi bi-camera-fill" viewBox="0 0 16 16">
                        <path d="M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0" />
                        <path
                          d="M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4zm.5 2a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1m9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0" />
                      </svg>
                    </div>
                    <div *ngIf="feature == 'Transfers'">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                        class="bi bi-car-front-fill" viewBox="0 0 16 16">
                        <path
                          d="M2.52 3.515A2.5 2.5 0 0 1 4.82 2h6.362c1 0 1.904.596 2.298 1.515l.792 1.848c.075.175.21.319.38.404.5.25.855.715.965 1.262l.335 1.679q.05.242.049.49v.413c0 .814-.39 1.543-1 1.997V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.338c-1.292.048-2.745.088-4 .088s-2.708-.04-4-.088V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.892c-.61-.454-1-1.183-1-1.997v-.413a2.5 2.5 0 0 1 .049-.49l.335-1.68c.11-.546.465-1.012.964-1.261a.8.8 0 0 0 .381-.404l.792-1.848ZM3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2m10 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6 8a1 1 0 0 0 0 2h4a1 1 0 1 0 0-2zM2.906 5.189a.51.51 0 0 0 .497.731c.91-.073 3.35-.17 4.597-.17s3.688.097 4.597.17a.51.51 0 0 0 .497-.731l-.956-1.913A.5.5 0 0 0 11.691 3H4.309a.5.5 0 0 0-.447.276L2.906 5.19Z" />
                      </svg>
                    </div>
                  </span>
                </div>
                <hr class="mt-2 mb-2" />
                <p class="fw-bold mb-1" style="font-size: 0.85rem">Inclusion:</p>
                <p class="card-text text-muted" style="font-size: 0.8rem">
                  {{ pkg.inclusions }}
                </p>

                <button class="btn btn-sm btn-outline-primary mt-auto w-100 text-uppercase fw-bold"
                  (click)="bookPackage(pkg)">
                  Book
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- offer section -->
    <div class="container-fluid d-flex flex-wrap align-items-center my-5 justify-content-between p-4" style="
      background: linear-gradient(to right, #f9b96f, #ffe1a0);
      color: white;
      border-radius: 10px;
      width: 95%;
    ">
      <div class="col-md-6 mb-4 mb-md-0">
        <h4 style="font-weight: bold">
          Bigger Group? Get special offers up to <br />50% Off!
        </h4>
        <p style="font-size: 1rem">
          We create unforgettable adventures, customised for your group.
        </p>
        <button class="btn btn-light border-0" style="color: #ff5722" (click)="onsupport()">
          Get A Callback
        </button>
      </div>
    </div>

    <!-- footer -->
    <app-footer></app-footer>

  </div>
</div>